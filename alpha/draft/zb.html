<!doctype html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <script>

window.addEventListener('load', function() {

  var $s = function(tagName) {
    return {
      $el: document.createElementNS(
          'http://www.w3.org/2000/svg', tagName),
      attrs: function(attrs) {
        for (var k in attrs) {
          this.$el.setAttribute(k, '' + attrs[k]);
        }
        return this;
      }
    };
  };

  var trimNum = function(n) {
    var d = Math.round(n * 100);
    var neg = false;
    if (d < 0) {
      neg = true;
      d = -d;
    };
    var s = '' + d;
    while (s.length < 3) {
      s = '0' + s;
    }
    return ((neg? '-' : '') +
      s.substring(0, s.length - 2) + '.' +
      s.substring(s.length - 2)).replace(/\.?0+$/, '');
  };

  var transformBuilder = function() {
    var t = '';
    return {
      translate: function(tx, ty) {
        t += ' translate(' + tx + ' ' + ty + ')';
        return this;
      },
      scale: function(sx, sy) {
        t += ' scale(' + sx + ' ' + sy + ')';
        return this;
      },
      rotate: function(angle) {
        t += ' rotate(' + angle + ')';
        return this;
      },
      skewY: function(angle) {
        t += ' skewY(' + angle + ')';
        return this;
      },
      build: function() { return t; }
    };
  };

  var d2t = function(d) { return d / 180 * Math.PI; };
  var t2d = function(t) { return t / Math.PI * 180; };

  var width = 250;
  var height = 250;
  var r = 100;
  var svg = $s('svg').attrs({
    width: 200, height: 200, viewBox: (-width / 2) + ' ' + (-height / 2) +
    ' ' + width + ' ' + height });
  document.body.appendChild(svg.$el);
  var tRect = $s('rect').attrs({ x: 0, y: 0, width: r, height: r,
    fill: 'none', stroke: '#00f' });
  var lRect = $s('rect').attrs({ x: 0, y: 0, width: r, height: r,
    fill: 'none', stroke: '#f00' });
  var rRect = $s('rect').attrs({ x: 0, y: 0, width: r, height: r,
    fill: 'none', stroke: '#0f0' });
  svg.$el.appendChild(tRect.$el);
  svg.$el.appendChild(lRect.$el);
  svg.$el.appendChild(rRect.$el);

  var p = document.getElementById('p');
  var t = document.getElementById('t');

  var inputHandler = function() {

    document.getElementById('pLabel').textContent = p.value;
    document.getElementById('tLabel').textContent = t.value;

    var pVal = +p.value * -1;
    var tVal = +t.value;

    var pCos = Math.cos(d2t(pVal) );
    var pSin = Math.sin(d2t(pVal) );
    var tCos = Math.cos(d2t(tVal) );
    var tSin = Math.sin(d2t(tVal) );

    var tTran = function(z) {
      return transformBuilder().
        translate(0, z * tCos).
        scale(1, tSin).
        rotate(pVal).
        translate(-r / 2, -r / 2).build();
    };
    var lTran = function(z, x) {
      return transformBuilder().
        translate(-x * pSin, x * pCos * tSin + z * tCos).
        skewY(t2d(Math.atan2(pSin * tSin, pCos) ) ).
        scale(pCos, tCos).
        translate(-r / 2, -r / 2).build();
    };
    var rTran = function(z, y) {
      return transformBuilder().
        translate(y * pCos, y * pSin * tSin + z * tCos).
        skewY(t2d(-Math.atan2(pCos * tSin, pSin) ) ).
        scale(pSin, tCos).
        translate(-r / 2, -r / 2).build();
    };

    tRect.$el.setAttribute('transform', tTran(0) );
    lRect.$el.setAttribute('transform', lTran(r / 2, r / 2) );
    rRect.$el.setAttribute('transform', rTran(r / 2, r / 2) );
  };

  inputHandler();
  p.addEventListener('input', inputHandler);
  t.addEventListener('input', inputHandler);
});

  </script>
</head>
<body>
<table>
  <tbody>
    <tr><th>Pan:</th><td id="pLabel"></td>
      <td><input id="p" type="range" min="-90" max="0" value="-35" /></td></tr>
    <tr><th>Tilt:</th><td id="tLabel"></td>
      <td><input id="t" type="range" min="0" max="90" value="30" /></td></tr>
  </tbody>
</table>
<br/>
</body>
</html>
